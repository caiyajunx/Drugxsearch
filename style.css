/* style.css */

/* 1. 定义 shadcn/ui 风格的浅色主题颜色变量 */
:root {
    --background: hsl(0 0% 100%);      /* 页面背景色 */
    --foreground: hsl(222.2 84% 4.9%); /* 主要文字颜色 */
    --card: hsl(0 0% 100%);            /* 卡片背景色 */
    --card-foreground: hsl(222.2 84% 4.9%);
    --popover: hsl(0 0% 100%);
    --popover-foreground: hsl(222.2 84% 4.9%);
    --primary: hsl(222.2 47.4% 11.2%);  /* 主要按钮/元素背景色 */
    --primary-foreground: hsl(210 40% 98%); /* 主要按钮文字颜色 */
    --secondary: hsl(210 40% 96.1%);
    --secondary-foreground: hsl(222.2 47.4% 11.2%);
    --muted: hsl(210 40% 96.1%);       /* 弱化元素背景色 */
    --muted-foreground: hsl(215.4 16.3% 46.9%); /* 弱化文字颜色 */
    --accent: hsl(210 40% 96.1%);
    --accent-foreground: hsl(222.2 47.4% 11.2%);
    --destructive: hsl(0 84.2% 60.2%); /* 危险/删除按钮背景色 */
    --destructive-foreground: hsl(210 40% 98%);
    --border: hsl(214.3 31.8% 91.4%);  /* 边框颜色 */
    --input: hsl(214.3 31.8% 91.4%);   /* 输入框边框颜色 */
    --ring: hsl(222.2 84% 4.9%);      /* 焦点环颜色 */
    --radius: 0.5rem;                 /* 全局圆角变量 */
}

/* 2. 应用基础样式 */
body {
    background-color: var(--background);
    color: var(--foreground);
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
}

.view-container.hidden { display: none !important; }

/* 3. 自定义组件样式 (模拟 shadcn/ui) */
.card {
    background-color: var(--card);
    color: var(--card-foreground);
    border-radius: var(--radius);
    border: 1px solid var(--border);
    box-shadow: 0 1px 3px 0 rgba(0,0,0,0.1), 0 1px 2px -1px rgba(0,0,0,0.1);
}
.card-header { padding: 1.5rem; padding-bottom: 0; }
.card-title { font-size: 1.5rem; font-weight: 600; letter-spacing: -0.025em; }
.card-description { color: var(--muted-foreground); margin-top: 0.5rem;}
.card-content { padding: 1.5rem; }
.card-footer { padding: 1.5rem; border-top: 1px solid var(--border); background-color: var(--muted); }

.label { font-size: 0.875rem; font-weight: 500; }

.input, .textarea, select.input {
    display: flex;
    width: 100%;
    border-radius: calc(var(--radius) - 2px);
    border: 1px solid var(--input);
    background-color: var(--background);
    padding: 0.5rem 0.75rem;
    font-size: 0.875rem;
    transition: all 0.2s;
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
}
select.input {
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
    background-position: right 0.5rem center;
    background-repeat: no-repeat;
    background-size: 1.5em 1.5em;
    padding-right: 2.5rem;
}

.input:focus, .textarea:focus, select.input:focus {
    outline: 2px solid transparent;
    outline-offset: 2px;
    border-color: var(--ring);
    box-shadow: 0 0 0 2px var(--ring);
}
.textarea { min-height: 80px; resize: vertical; }
.textarea.input-sm { font-size: 0.875rem; padding: 0.5rem 0.75rem; }


/* Styles for password toggle button */
.password-toggle-btn {
    position: absolute;
    top: 50%;
    right: 0.5rem;
    transform: translateY(-50%);
    background: transparent;
    border: none;
    cursor: pointer;
    color: var(--muted-foreground);
    padding: 0.25rem;
    display: inline-flex;
    align-items: center;
    justify-content: center;
}
.password-toggle-btn:hover {
    color: var(--foreground);
}
.password-toggle-btn svg {
    width: 1rem;
    height: 1rem;
}

.button {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    border-radius: calc(var(--radius) - 2px);
    font-weight: 500;
    padding: 0.5rem 1rem;
    transition: background-color 0.2s;
    cursor: pointer;
    white-space: nowrap;
}
.button-primary { background-color: var(--primary); color: var(--primary-foreground); }
.button-primary:hover { background-color: hsl(222.2 47.4% 20%); }
.button-outline { border: 1px solid var(--input); background-color: var(--background); }
.button-outline:hover { background-color: var(--accent); }
.button-destructive { background-color: var(--destructive); color: var(--destructive-foreground); }
.button-destructive:hover { background-color: hsl(0 84.2% 70%); }
.button-ghost { border: none; background: transparent; }
.button-ghost:hover { background-color: var(--accent); }
.button-sm { padding: 0.25rem 0.75rem; font-size: 0.875rem; }
.button-lg { padding: 0.75rem 1.5rem; font-size: 1.125rem; }


.alert { background-color: var(--muted); padding: 0.75rem; border-radius: var(--radius); }
.separator { height: 1px; background-color: var(--border); }

/* 4. Markdown 内容区 (prose) 样式 */
.prose h1, .prose h2, .prose h3 { font-weight: 600; margin-top: 1.5em; margin-bottom: 0.6em; }
.prose h1 { font-size: 2em; }
.prose h2 { font-size: 1.5em; }
.prose h3 { font-size: 1.25em; }
.prose p { margin-bottom: 1.25em; line-height: 1.7; }
.prose ul, .prose ol { margin-left: 1.5rem; margin-bottom: 1.25em; }
.prose li { margin-bottom: 0.5em; }
.prose a { color: var(--primary); text-decoration: underline; }
.prose strong { font-weight: 600; }
.prose blockquote { border-left: 4px solid var(--border); padding-left: 1rem; color: var(--muted-foreground); }
.prose .citation-marker {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 1.1rem;
    height: 1.1rem;
    background-color: hsl(222deg 5.15% 89.07% / 70%);
    color: #4a4a4a;
    font-size: 0.6rem;
/*    font-weight: bold;*/
    border-radius: 50%;
    margin: 0 0.125rem;
    vertical-align: middle;
}


/* 5. 引用来源折叠样式 */
.source-header {
    padding: 0.75rem; cursor: pointer; display: flex;
    justify-content: space-between; align-items: center;
    background-color: var(--background); border: 1px solid var(--border);
    border-radius: var(--radius);
}
.source-header:hover { background-color: var(--accent); }
.source-header a { font-size: 0.875rem; font-weight: 500; text-decoration: none; color: var(--foreground); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.source-header a:hover { text-decoration: underline; }
.source-header::after { content: '▼'; font-size: 0.8em; transition: transform 0.2s; }
.source-header.expanded::after { transform: rotate(180deg); }
.source-snippet {
    display: none; padding: 0.75rem;
    font-size: 0.875rem; color: var(--muted-foreground);
    border: 1px solid var(--border); border-top: 0;
    border-bottom-left-radius: var(--radius); border-bottom-right-radius: var(--radius);
}
.source-snippet.expanded { display: block; }

/* 6. 时间轴样式 */
.timeline {
    display: flex;
    justify-content: space-between;
    position: relative;
}
.timeline::before {
    content: '';
    position: absolute;
    top: 10px; /* Center with the dot */
    transform: translateY(-50%);
    left: 0;
    width: 100%;
    height: 2px;
    background-color: var(--border);
    z-index: -1;
}
.timeline-node {
    position: relative;
    text-align: center;
    flex: 1;
}
.timeline-node-dot {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background-color: var(--background);
    border: 4px solid var(--border);
    margin: 0 auto;
    transition: all 0.3s ease;
    cursor: pointer;
}
.timeline-node-label {
    margin-top: 0.75rem;
    font-size: 0.875rem;
    color: var(--muted-foreground);
    font-weight: 500;
}

/* 节点状态 */
.timeline-node.active .timeline-node-dot {
    border-color: var(--primary);
    animation: pulse 1.5s infinite;
}
.timeline-node.active .timeline-node-label { color: var(--primary); }

.timeline-node.completed .timeline-node-dot {
    background-color: var(--primary);
    border-color: var(--primary);
}
.timeline-node.completed .timeline-node-label { color: var(--foreground); }

.timeline-node.error .timeline-node-dot {
    background-color: var(--destructive);
    border-color: var(--destructive);
}
.timeline-node.error .timeline-node-label { color: var(--destructive); }

/* 详情面板样式 */
#timeline-details-panel h4 { font-size: 1.125rem; font-weight: 600; margin-bottom: 0.75rem; }
#timeline-details-panel pre { background-color: var(--muted); padding: 0.75rem; border-radius: var(--radius); white-space: pre-wrap; word-break: break-all; }

@keyframes pulse {
    0% { box-shadow: 0 0 0 0 hsla(222, 47%, 11%, 0.7); }
    70% { box-shadow: 0 0 0 10px hsla(222, 47%, 11%, 0); }
    100% { box-shadow: 0 0 0 0 hsla(222, 47%, 11%, 0); }
}